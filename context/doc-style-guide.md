# ドキュメントスタイルガイド
<!-- last_updated: 2026-02-11 -->
読者: エージェント（人間向け散文禁止）
最終更新: 2026-02-11

## Vercel実証5原則

| # | 原則 | ルール | 根拠 |
|---|------|--------|------|
| 1 | **圧縮索引** | パイプ区切り・最小スペース・テーブル形式。散文→圧縮で80%削減しても性能維持 | 40KB→8KBで100%pass（スキル79%に圧勝） |
| 2 | **命令形** | 「〜せよ」「NEVER」「MUST」で書け。説明文・背景はdocs/（人間層）へ | 曖昧表現→行動のブレ。命令形→即行動 |
| 3 | **推測禁止** | 「このファイルを読め。推測するな」を明示せよ。ファイルパス・コマンドを具体的に指定 | 推測=幻覚。読ませれば正確 |
| 4 | **実例** | 抽象ルールより実コマンド・実パス・実YAML。コピペで動くレベル | "explore first">"invoke first"で行動差大 |
| 5 | **探索優先** | 「まず探索(Glob/Grep/Read)、次に参照(Memory/Skill)」の順序を指示 | retrieval-led > pre-training-led。受動的ロード > 能動的判断 |

## 3層分離

| 層 | 場所 | ロード | 判断回数 | 内容 | 書き方 |
|----|------|--------|---------|------|--------|
| L1 | CLAUDE.md | 自動（毎ターン） | 0回 | 圧縮索引・日常ルール・判断基準 | Vercelスタイル必須。テーブル・パイプ・命令形 |
| L2 | context/*.md | `Read`で明示読み | 1回 | プロジェクト詳細・手順・根拠 | Vercelスタイル必須。L1より詳細OK |
| L3 | docs/ | 人間が読む | N/A | 設計書・議事録・説明文 | 散文OK。人間向け |

**原則**: L1に結論、L2に根拠と手順、L3に経緯と説明。上位層ほど圧縮度を高くせよ。

## Before/After例

### 例1: 散文 → 圧縮索引

**Before（散文・L3スタイル）**:
```
inbox_watcher.shはinotifywaitを使ってqueue/inbox/配下のYAMLファイルの
変更を監視しています。変更を検知すると、tmuxのsend-keysを使って短い
ナッジメッセージを送信します。ナッジの形式は「inboxN」で、Nは未読
メッセージ数です。メッセージの内容自体は送信しません。
```

**After（圧縮索引・L1スタイル）**:
```
inbox: inbox_write.sh→YAML書込→inbox_watcher検知→nudge(inboxN)。内容は送らない
```

### 例2: 説明文 → 命令形

**Before（説明文・L3スタイル）**:
```
ダッシュボードの時刻は正確である必要があります。WSL2環境では
タイムゾーンの設定によって時刻がずれることがあるため、
dateコマンドの出力を確認してからダッシュボードに記入すると
良いでしょう。
```

**After（命令形・L2スタイル）**:
```
Dashboard時刻ルール: `date "+%Y-%m-%d %H:%M"` を実行し出力をコピペせよ。推測禁止。
```

### 例3: 抽象ルール → 実例

**Before（抽象）**:
```
エージェント間通信には適切なスクリプトを使用してください。
```

**After（実例）**:
```bash
bash scripts/inbox_write.sh karo "半蔵、任務完了。" report_received hanzo
```

## Vercel研究の根拠

| 発見 | 数値 | 意味 |
|------|------|------|
| 8KB圧縮docs index | 100% pass率 | スキル(79%)・RAG(68%)に圧勝。小さく正確な索引が最強 |
| 文言の行動差 | "explore first" >> "invoke first" | 単語の選び方でエージェント行動が激変 |
| retrieval-led | > pre-training-led | 「読ませる」が「知っているはず」に常に勝つ |
| 受動的ロード | > 能動的ロード | CLAUDE.md(判断0回) > Memory MCP/スキル(判断2回)。取りこぼしゼロ |

**結論**: ドキュメントは「エージェントが読んで即行動できる」形式で書け。人間が読んで理解する形式はL3に置け。
